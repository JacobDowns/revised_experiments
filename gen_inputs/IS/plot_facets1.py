from pylab import *

f_indexes = loadtxt('f_indexes.txt')
f_xs = loadtxt('f_xs.txt')
f_ys = loadtxt('f_ys.txt')

vx1 = loadtxt('vx1.txt')
vy1 = loadtxt('vy1.txt')
vx2 = loadtxt('vx2.txt')
vy2 = loadtxt('vy2.txt')
nxs = loadtxt('nxs.txt')
nys = loadtxt('nys.txt')

flips = []
reverses1 = set([1055, 3472, 3496, 3894, 3919, 3944, 3950, 4560, 7588, 9273, 9376, 9742,
9744, 10082, 10937, 11854, 12444, 12445, 12554, 12682, 12779, 12780, 13267, 14498,
15946, 16122, 16588, 19366, 20573, 20575, 21209, 21211, 23601, 23864, 24670, 24671,
25249, 28037, 29783, 30925, 30945, 30971, 30972, 31735, 31762, 33856, 36316, 38230,
38365, 40204, 40581, 40832, 40833, 42208, 42305, 42308, 42386, 42749, 43345, 44309,
44413, 44414, 46340, 46492, 46494, 48099, 48188, 48543, 48544, 49183, 49824, 50115,
52881, 52896, 53495, 54158, 54759, 54983, 56103, 56873, 56874, 57244, 58257, 58536,
59444, 59445, 59567, 59722, 59822, 60749])

reverses2 = set([61825, 59445, 12682, 57643, 3894, 46340, 19365, 19366, 16126, 4202,
48933, 61656, 3497, 3496, 31737, 12063, 31760, 54158, 10081, 54788, 42308, 9276, 12445,
4561, 15943, 49453, 58536, 36315, 52897, 9744, 58536, 36315, 52897, 9744, 48096, 59882,
16588, 16592, 11315, 11310, 36651, 15217, 45217, 57244, 9376, 30152, 48188])


for i in range(len(f_indexes)):
  index = int(f_indexes[i])
  plot([vx1[i], vx2[i]], [vy1[i], vy2[i]], 'ko-')
  #plot([f_xs[i]], [f_ys[i]], 'ko', ms = 5)
  text(f_xs[i], f_ys[i], str(int(f_indexes[i])))

  flip = 1.0

  if index in reverses1:
    flip *= -1.0
  if index in reverses2:
    flip *= -1.0

  flips.append(flip)

  plot([f_xs[i], f_xs[i] + flip*nxs[i]], [f_ys[i], f_ys[i] + flip*nys[i]], 'ro-')

print flips
savetxt('flips.txt', array(flips)) 

show()
